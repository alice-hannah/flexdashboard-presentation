---
title: "Building Management <br> Reports using the <br> flexdashboard package"
subtitle: "PHI useR Group"
author: 'Alice Byers <br> Information Services Division <br>'
date: "25 February 2020 <br><br> Slides: https://github.com/alicebyers5/useR-presentation"
output:
  ioslides_presentation:
    widescreen: true
    css: my-theme.css
---

```{r setup, include = FALSE}
# Load packages required
library(knitr)

knitr::opts_chunk$set(echo = TRUE)

error_hook <- knitr::knit_hooks$get("error")
knitr::knit_hooks$set(error = function(x, options) {
  if (!is.null(n <- options$linewidth)) {
    x = knitr:::split_lines(x)
    if (any(nchar(x) > n)) x = strwrap(x, width = n)
    x = paste(x, collapse = '\n')
  }
  error_hook(x, options)
})
```


## Background and Motivation

- Quarterly management reports for [Dementia Post Diagnostic Support (PDS)](https://www.isdscotland.org/Health-Topics/Mental-Health/Dementia-Post-diagnostic-Support/) data

- SPSS used for data preparation and calculating measures

- Excel used to present data

- New data recording guidance prompted review of methodology and presentation of management reports


## Why flexdashboard?

- Uses R Markdown to produce interactive dashboards

- Output as standalone html file
    - Restricted access by sending via email
    - Universal file format
    - No requirement for password protected shiny server

- The production process can be automated using R

- Looks good!


## Using subpages to avoid duplication of code

Requirement for seperate page/view for each Health Board and Financial Year. Wanted to avoid writing the same code multiple times to produce the same output for each combination of HB/FY. 

Account for some differences; e.g. some Health Boards only have one Integration Joint Board (IJB) within them and so don't require this breakdown on their referrals chart. For more recent financial years where data is still incomplete, performance figures are not presented.


## Using subpages to avoid duplication of code

Text

```{r, message = FALSE}
library(testthat)

expect_equal(2 + 3, 5)
expect_error(sum(1, "two"))
```

Text

```{r, error = TRUE}
expect_lt(3, 2)
```


## Using `ggplotly` for interactive charts


## Next Steps

- Automate date in navbar so dashboard is fully automated

- Improve comments/documentation of code

- Develop further data analysis

- Develop as shiny dashboard when infrastructure available


## Contact & Links

### Alice Byers - Health & Social Care Team

- Email - [alice.byers@nhs.net](mailto:alice.byers@nhs.net)

- GitHub - [alicebyers5](https://github.com/alicebyers5)


### Useful Links

- [`flexdashboard`](https://rmarkdown.rstudio.com/flexdashboard/index.html)

- [Tutorial to use subpages](https://somtom.github.io/post/using-dynamically-rendered-r-markdown-childs-for-reports/)

